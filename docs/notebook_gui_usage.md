# Yufmath 笔记本图形界面使用指南

## 概述

Yufmath 笔记本提供了一个现代化的图形用户界面，类似于 Jupyter Notebook，专门用于交互式数学计算。

## 启动方式

### 1. 默认图形界面模式

```bash
# 启动新的笔记本（默认使用图形界面）
yufmath notepad

# 打开现有笔记本文件
yufmath notepad notebook.ynb

# 创建带标题的新笔记本
yufmath notepad --title "我的数学笔记"
```

### 2. 终端界面模式

如果您更喜欢在终端中工作，可以使用 `--terminal` 参数：

```bash
# 强制使用终端界面
yufmath notepad --terminal

# 在终端中打开现有笔记本
yufmath notepad --terminal notebook.ynb
```

## 图形界面功能

### 界面布局

```
┌─────────────────────────────────────────────────────────┐
│ 菜单栏 (文件、编辑、运行、帮助)                           │
├─────────────────────────────────────────────────────────┤
│ 工具栏 (新建代码、新建文档、运行、运行全部、保存)          │
├─────────────────────────────────────────────────────────┤
│ 滚动区域                                                │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ [代码] 单元格 1                                     │ │
│ │ 2 + 3 * 4                                          │ │
│ │ 输出: 14                                           │ │
│ ├─────────────────────────────────────────────────────┤ │
│ │ [文档] 单元格 2                                     │ │
│ │ # 计算结果                                         │ │
│ │ 上面的计算结果是 14                                │ │
│ ├─────────────────────────────────────────────────────┤ │
│ │ [代码] 单元格 3                                     │ │
│ │ sin(pi/2)                                          │ │
│ │ 输出: 1                                            │ │
│ └─────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│ 状态栏 (就绪 | 单元格 1 | Ctrl+H 显示帮助)               │
└─────────────────────────────────────────────────────────┘
```

### 单元格类型

1. **代码单元格** `[代码]`
   - 用于输入和执行数学表达式
   - 支持语法高亮
   - 显示计算结果

2. **文档单元格** `[文档]`
   - 用于编写 Markdown 格式的文档
   - 支持标题、列表、链接等
   - 用于添加说明和注释

3. **文本单元格** `[文本]`
   - 用于编写纯文本
   - 简单的文本记录

## 快捷键

### 单元格操作
- **Ctrl+N** - 新建代码单元格
- **Ctrl+M** - 新建文档单元格
- **Ctrl+D** - 删除当前单元格

### 执行操作
- **Ctrl+Enter** - 执行当前单元格
- **Shift+Enter** - 执行当前单元格并新建下一个
- **Ctrl+R** - 执行所有单元格

### 文件操作
- **Ctrl+S** - 保存笔记本
- **Ctrl+O** - 打开笔记本
- **Ctrl+Shift+S** - 另存为

### 导航操作
- **↑/↓** - 在单元格间移动
- **Enter** - 进入编辑模式
- **Escape** - 退出编辑模式

### 其他
- **Ctrl+H** - 显示帮助
- **Ctrl+Q** - 退出应用

## 自动补全功能

### 智能提示

在代码单元格中输入时，系统会自动显示相关的补全建议：

1. **函数补全**
   - 输入 `sin` → 显示 `sin(x)` 及其描述
   - 输入 `sqrt` → 显示 `sqrt(x)` 及其描述

2. **常量补全**
   - 输入 `p` → 显示 `pi = 3.14159...`
   - 输入 `e` → 显示 `e = 2.71828...`

3. **变量补全**
   - 自动补全您之前定义的变量
   - 显示变量的当前值

### 使用方法

- **自动触发**: 输入时自动显示建议
- **手动触发**: 按 `Ctrl+Space` 显示补全菜单
- **选择建议**: 使用方向键选择，按 `Enter` 确认

## 数学计算示例

### 基本运算

```
# 代码单元格
2 + 3 * 4
# 输出: 14

# 代码单元格
sqrt(16)
# 输出: 4
```

### 代数运算

```
# 代码单元格
x^2 + 2*x + 1
# 输出: x^2 + 2*x + 1

# 代码单元格
simplify((x+1)^2)
# 输出: x^2 + 2*x + 1
```

### 微积分

```
# 代码单元格
diff(x^3 + 2*x^2 + x, x)
# 输出: 3*x^2 + 4*x + 1

# 代码单元格
integrate(2*x + 1, x)
# 输出: x^2 + x + C
```

### 三角函数

```
# 代码单元格
sin(pi/2)
# 输出: 1

# 代码单元格
cos(0)
# 输出: 1
```

## 文件格式

### .ynb 格式

Yufmath 使用 `.ynb` 格式保存笔记本，这是一个基于 TOML 的文本格式：

```toml
format_version = "1.0"

[notebook.metadata]
title = "我的笔记本"
created_at = "2024-01-01T00:00:00Z"
modified_at = "2024-01-01T12:00:00Z"

[[notebook.cells]]
id = "cell-1"
cell_type = "Code"
text = "2 + 3"

[[notebook.cells]]
id = "cell-2"
cell_type = "Markdown"
text = "# 结果\n\n上面的计算结果是 5"
```

### 兼容性

- **版本控制友好**: 纯文本格式，易于版本控制
- **可读性强**: TOML 格式易于人类阅读和编辑
- **扩展性好**: 支持添加新的元数据和单元格类型

## 故障排除

### 图形界面无法启动

如果图形界面无法启动，系统会自动显示错误信息并提供解决建议：

```
警告：未检测到图形环境，将使用终端界面
提示：
  - 确保在图形桌面环境中运行
  - 如果使用 SSH，请使用 -X 或 -Y 参数启用 X11 转发
  - 或者使用 --terminal 参数强制使用终端界面
```

### 解决方案

1. **Linux/Unix 系统**:
   ```bash
   # 检查 DISPLAY 环境变量
   echo $DISPLAY
   
   # 如果使用 SSH，启用 X11 转发
   ssh -X username@hostname
   
   # 或者使用终端界面
   yufmath notepad --terminal
   ```

2. **Windows 系统**:
   - 确保在图形桌面环境中运行
   - 如果使用 WSL，可能需要安装 X11 服务器

3. **macOS 系统**:
   - 通常不需要特殊配置
   - 确保在终端应用中运行

### 性能问题

如果遇到性能问题：

1. **大型笔记本**: 考虑将大型笔记本分割为多个小文件
2. **复杂计算**: 使用 `Ctrl+C` 中断长时间运行的计算
3. **内存使用**: 定期保存并重启应用以释放内存

## 高级功能

### 变量管理

在代码单元格中定义的变量会在整个笔记本中共享：

```
# 单元格 1
x = 10

# 单元格 2
y = x * 2
# 输出: 20

# 单元格 3
z = x + y
# 输出: 30
```

### 批量执行

使用 `Ctrl+R` 或菜单中的"运行所有单元格"来批量执行：

- 按顺序执行所有代码单元格
- 跳过文档和文本单元格
- 显示执行进度
- 在出错时停止并显示错误信息

### 导出功能

虽然当前版本主要支持 `.ynb` 格式，但未来版本将支持导出为：

- **HTML**: 用于网页显示
- **PDF**: 用于打印和分享
- **Markdown**: 用于文档编写

## 示例笔记本

### 数学分析示例

```markdown
# 数学分析练习

## 1. 极限计算

计算以下极限：
```

```
limit(sin(x)/x, x, 0)
# 输出: 1
```

```markdown
## 2. 导数计算

求函数 f(x) = x³ + 2x² + x 的导数：
```

```
f = x^3 + 2*x^2 + x
diff(f, x)
# 输出: 3*x^2 + 4*x + 1
```

```markdown
## 3. 积分计算

计算不定积分：
```

```
integrate(3*x^2 + 4*x + 1, x)
# 输出: x^3 + 2*x^2 + x + C
```

### 线性代数示例

```markdown
# 线性代数练习

## 矩阵运算
```

```
A = matrix([[1,2],[3,4]])
B = matrix([[5,6],[7,8]])
A * B
# 输出: [[19,22],[43,50]]
```

```markdown
## 行列式计算
```

```
det(A)
# 输出: -2
```

## 总结

Yufmath 笔记本图形界面提供了一个强大而直观的数学计算环境。通过结合代码执行、文档编写和智能补全功能，它使得复杂的数学计算变得更加高效和愉快。

无论您是学生、教师还是研究人员，这个工具都能帮助您更好地进行数学探索和学习。